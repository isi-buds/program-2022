---
title: 'Day 2 Lab Solutions: Inversion formula and rejection sampling'
output: html_document
date: '2022-07-12'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  fig.align = "center",
  warning = FALSE,
  message = FALSE
)
```

**1.** We will use the inversion method to sample from a Cauchy distribution. 

**1a.** Recall the pdf and cdf of Cauchy(t, s):  
$f(x) = \frac{1}{s\pi(1 + (x-t)^2/s^2)}$,  
$F(x) = \frac{1}{2} + \frac{1}{\pi}\tan^{-1}(\frac{x-t}{s})$.  
Find the inverse of the cdf.

**1b.** Use `set.seed(2431)` to set you seed, and sample 20,000 uniform random variables using `runif()`. Use the inversion method to obtain 20,000 samples from a Cauchy(t = 1, s = 0.5).

**1c.** Make a histogram of your samples obtained using the inversion formula. Compare your histogram to the one below, generated by directly drawing random samples using `rcauchy()`.

```{r}
cauchy_samples <- rcauchy(n = 20000, location = 1, scale = 0.75)
hist(cauchy_samples, breaks = 30)
```


**2.** Suppose we want to sample from the pdf 
$$f(x) = 1.2 - x^4$$

```{r, echo = FALSE}
x <- seq(from = 0, to = 1, length = 1000)
plot(x = x, y = 1.2 - x^4, type = "l", col = "blue", ylab = "")
legend(
  "bottomleft", 
  legend = c("f(x) = 1.2 - x^4"),
  col = c("blue"),
  lty = c(1)
)
```

We will use rejection sampling to sample from this distrbution.

**2a.** First we need a proposal density, $q(x)$, that covers our target density. The support (i.e. possible values of x) of the target density is (0, 1). One possible proposal density is a standard uniform density since it is also (0, 1), and we know the support of the target density must be a subset of the support of the proposal density. 

```{r, echo = FALSE}
x <- seq(from = 0, to = 1, length = 1000)
plot(x = x, y = 1.2 - x^4, type = "l", col = "blue", lty = 1, ylab = "")
points(x = x, y = rep(1, 1000), type = "l", col = "red", lty = 2)
legend(
  "bottomleft", 
  legend = c("f(x) = 1.2 - x^4", "g(x) = 1"),
  col = c("blue", "red"),
  lty = c(1, 2)
)
```

The pdf of a standard normal is the constant 1, $g(x) = 1$. We need to find a $M$ to make $g(x)$ cover $f(x)$, i.e. 
$$M * q(x) \geq f(x).$$
What is an appropriate range of $M$ values to choose? Which value of $M$ would be the most efficient choice and why?

**2b.**  For our chosen $M$ we will now generate random uniform(0, 1) samples, $u$ and accept the sample if $$u \leq  \frac{f(x)}{Mg(x)}$$. Do this sampling until you get 10,000 samples from our target distribution. Comment on what proportion of you samples from $q(x)$ were accepted as samples from $f(x)$.

**2c.** Plot a histogram of your samples from the target distribution. Do your samples look like they came from the target distribution? 

**2d.** How would the percent of accepted sample change is we used a larger $M$? What about if we chose to use a Uniform(0, 3) as our proposal distribution?